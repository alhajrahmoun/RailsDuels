<%= turbo_stream_from "custom_duel_#{@duel.id}" %>

<% if @duel.starting? %>
  <h3>Custom Duel #<%= @duel.id %></h3>

  <% if @participant %>
    <%= button_to "leave", custom_duel_participant_path(@duel, @participant.id), method: :delete, class: 'btn btn-danger', id: 'duel-leave-button' %>
  <% end %>

  <% if current_user == @duel.leader %>
    <%= button_to "start", start_custom_duel_path(@duel), method: :patch, class: 'btn btn-success' %>
    <%= join_custom_duel_url(@duel, code: @duel.invitation_code) %>
  <% end %>

  <div class="row">
    <div class="offset-4 col-4">
      <h5>Participants:</h5>

      <div id="starting_countdown"></div>
      <div id="custom-duel-<%= @duel.id %>-participants">
        <%= render 'participants', duel: @duel %>
      </div>
    </div>
  </div>
<% else %>
  <div class="row">
    <div class="col-4">
      <%= render 'custom_duels/duel_progress', duel: @duel, user: current_user %>
    </div>

    <div class="col-8">
      <%= render 'custom_duels/duel', duel: @duel %>
    </div>
  </div>
<% end %>
